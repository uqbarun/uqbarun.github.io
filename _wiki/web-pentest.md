---
title: Web pentest
---

# Web pentest

## Gu√≠as 
* OTG
* WSTG o WASTG
* NIST SP 800-115

## OTG vs WSRG
La Gu√≠a de Pruebas del OWASP (**OTG**, por sus siglas en ingl√©s) y la Gu√≠a de Pruebas de Seguridad Web (**WSTG**, por sus siglas en ingl√©s) son dos gu√≠as exhaustivas para la realizaci√≥n de pruebas de seguridad en aplicaciones web. Sin embargo, existen algunas diferencias clave entre ambas gu√≠as.

| Caracter√≠stica | OTG 						| WSTG 
|---			 |---						|---	
| Alcance 		 | Cubre todos los aspectos de la seguridad de las aplicaciones web | Se centra en las pruebas de penetraci√≥n 
| Profundidad 	 | Visi√≥n general general   | Instrucciones detalladas
| Audiencia 	 | Cualquier persona interesada en aprender sobre la seguridad de las aplicaciones web | Testers de penetraci√≥n 

## Recopilaci√≥n de informaci√≥n

### WSTG-INFO-01: Fugas de informaci√≥n con motores de b√∫squeda

#### üéØ Objetivos

* Puntos de entrada (*Footholds*)
* Archivos que contienen nombres de usuario
* Directorios confidenciales
* Detecci√≥n de servidor web
* Archivos vulnerables
* Servidores Vulnerables
* Error de mensajes
* Archivos que contienen informaci√≥n jugosa
* Archivos que contienen contrase√±as
* Informaci√≥n confidencial de compras en l√≠nea

#### üõ†Ô∏è Herramientas

* [Google Hacking Database](https://www.exploit-db.com/google-hacking-database)
* [Shodan](https://help.shodan.io/the-basics/search-query-fundamentals)

### WSTG-INFO-02: Fingerprint de servidor web

http://www.net-square.com/httprint_paper.html

Ataques:
* [CAPEC-224: Fingerprinting](https://capec.mitre.org/data/definitions/224.html)
* [CAPEC-312: Active OS Fingerprinting](https://capec.mitre.org/data/definitions/312.html)
* [CAPEC-170: Web Application Fingerprinting](https://capec.mitre.org/data/definitions/170.html)
* [WASC-45: Fingerprinting](http://projects.webappsec.org/w/page/13246925/Fingerprinting)
* [ATT&CK-T1082: System Information Discovery ](https://attack.mitre.org/techniques/T1082/)

Debilidades:
* [CWE-200: Exposure of Sensitive Information to an Unauthorized Actor](https://cwe.mitre.org/data/definitions/200.html)
* [WASC-13: Information Leakage (Weakness)](http://projects.webappsec.org/w/page/13246936/Information%20Leakage)

#### üéØ Objetivo 

* Hardware
* Tipo de servidor
* Versi√≥n del servidor

#### üõ†Ô∏è Herramientas

* [Netcraft](https://sitereport.netcraft.com), una herramienta en l√≠nea que escanea sitios web en busca de informaci√≥n, incluido el servidor web.
* [Nikto](https://github.com/sullo/nikto), una herramienta de escaneo de l√≠nea de comandos de c√≥digo abierto.
	* `nikto -host <target>`
* **Nmap**, una herramienta de l√≠nea de comandos de c√≥digo abierto que tambi√©n tiene una GUI, [Zenmap](https://nmap.org/zenmap).
    * `nmap -sV --script fingerprint-strings <target>`
* Shodan
* Alertas de `Information Leakage` en [ZAP](https://www.kali.org/tools/zaproxy/)
* [wappalyzer](https://www.wappalyzer.com/lookup/) Herramienta en l√≠nea
* [Firefox wappalyzer Add-on](https://addons.mozilla.org/es/firefox/addon/wappalyzer/)
* [WhatWeb](https://github.com/urbanadventurer/WhatWeb)

### WSTG-INFO-03: Fugas de informaci√≥n con metarchivos 

#### üéØ Objetivo 

Identificar rutas y funcionalidades ocultas o obfuscadas a trav√©s del an√°lisis de archivos de metadatos, y extraer y mapear otra informaci√≥n que pueda conducir a una mejor comprensi√≥n de los sistemas en cuesti√≥n.

* [robots.txt](https://www.robotstxt.org/)
* [META Tags](https://www.robotstxt.org/meta.html)
* [Sitemaps](https://www.sitemaps.org/protocol.html)
* [security.txt](https://securitytxt.org/)


#### üõ†Ô∏è Herramientas

* Dev Tools del navegador web
* curl
* wget
* Robots/Spider/crwaler de [ZAP](https://www.kali.org/tools/zaproxy/)
* Robots/Spider/crwaler de [Burp Suite](https://portswigger.net/burp/communitydownload)

### WSTG-INFO-04: Enumerar aplicaciones

#### üéØ Objetivo 

* urls, domninios y subdomnios
* software y puertos
* Virtual hosts

#### üõ†Ô∏è Herramientas

* nslookup, permite consultar y obtener informaci√≥n de registros DNS y direcciones IP.
* dig, m√°s avanzada y flexible para realizar consultas de DNS que nslookup.
* [DNSdumpster](https://dnsdumpster.com/), es un buscador en l√≠nea de dominios que proporciona informaci√≥n detallada sobre registros DNS y subdominios.
* Nmap, `nmap ‚ÄìPn ‚ÄìsT ‚ÄìsV ‚Äìp0-65535 192.168.1.100`
* Telnet, `telnet 192.168.10.100 8000`
* Nesus
* Nikto
	* `nikto -host <target>`
* vhost de Gobuster https://github.com/OJ/gobuster
 
### WSTG-INFO-05: Fugas de informaci√≥n en el contenido

#### üéØ Objetivo 

* Comentarios en html, css, js, etc.
* Fugas en c√≥digo JS como Tokens y API keys.
* [Source maps](https://web.dev/source-maps/) o depuradores front-end.

#### üõ†Ô∏è Herramientas

* Dev Tools del navegador web
* curl
* wget
* Robots/Spider/crwaler de **ZAP**
* Robots/Spider/crwaler de **Burp Suite**
* [waybackurls](https://github.com/tomnomnom/waybackurls), da URLs de [Wayback Machine](https://archive.org/web/)

## WSTG-INFO-06: Puntos de entrada

#### üéØ Objetivo 

* [API Endpoints](https://www.techtarget.com/searchapparchitecture/definition/API-endpoint) y sus acciones HTTP (GET, POST, PUT, OPTION, DELETE)
* Respuestas HTTP `HTTP 3xx`, `HTTP 403`, `HTTP 500`.
* Par√°metros de ruta `/bogota/edificios/453` 
* Par√°metros de consulta, Ej.: `/bogota/edificios/salones?category=computaci√≥n&debug=false` 
* Par√°metros de body request, Ej.: `{ user:foo, pass:bar }`
* Encabezados de respuestas 
     * Del servidor: `Server`, `X-Powered-By`
     * Cookies: `Set-Cookie`
     * De seguridad: `X-XSS-Protection`, `Access-Control-Allow-Origin`, `HTTP Strict Transport Security` ([SSL Stripping](https://www.encryptionconsulting.com/hsts-and-ssl-stripping-attack))

#### üõ†Ô∏è Herramientas

* https://gitlab.com/kalilinux/packages/dirbuster.git
* [Complete guide to HTTP Headers for securing websites (Cheat Sheet)](https://github.com/TheSmartScanner/http-headers-security)
* [Mozilla Observatory](https://observatory.mozilla.org/), es una herramienta que permite verificar el estado de los encabezados
* Pluggin [OWASP ASD](https://owasp.org/www-project-attack-surface-detector/) para ZAP y Brup Suite
    * <https://github.com/secdec/attack-surface-detector-zap/wiki>
* [attack-surface-detector-cli](https://github.com/secdec/attack-surface-detector-cli/releases)


## WSTG-INFO-06: Mapear rutas de ejecuci√≥n

#### üéØ Objetivo 

OWASP DirBuster https://gitlab.com/kalilinux/packages/dirbuster.git 





###

2. Examine la versi√≥n del software. Detalles de la base de datos, el componente t√©cnico de error, errores por los c√≥digos de error al solicitar p√°ginas no v√°lidas.

3. Implementar t√©cnicas como consultas inversas de DNS, transferencias de zonas de DNS, b√∫squedas de DNS basadas en la web.

4. Realice b√∫squedas de estilo de directorio y escaneo de vulnerabilidades, sondee para URL, utilizando herramientas como NMAP y Nessus .

5. Identifique el punto de entrada de la aplicaci√≥n utilizando Burp Proxy , OWSAP ZAP, TemperIE, WebscarabTemper Data .

6. Mediante el uso de la herramienta tradicional de huellas dactilares como Nmap, Amap , realice TCP/ICMP y servicio de huellas dactilares.

7. Al solicitar una extensi√≥n de archivo com√∫n como. ASP, EXE, .HTML, .PHP , prueba de tipos de archivo/extensiones/directorios reconocidos.

8. Examine el c√≥digo fuente de las p√°ginas de acceso de la interfaz de la aplicaci√≥n.
Pruebas de autenticaci√≥n

1. Verifique si es posible "reutilizar" la sesi√≥n despu√©s de cerrar la sesi√≥n. Tambi√©n verifique si la aplicaci√≥n cierra autom√°ticamente la sesi√≥n de un usuario que ha estado inactivo durante un cierto per√≠odo de tiempo.

2. Verifique si alguna informaci√≥n confidencial permanece almacenada en la memoria cach√© del navegador.

3. Verifique e intente Restablecer la contrase√±a, mediante ingenier√≠a social descifre preguntas secretas y adivinanzas.

4. Verifique si el mecanismo "Recordar mi contrase√±a" est√° implementado al verificar el c√≥digo HTML de la p√°gina de inicio de sesi√≥n.

5. Compruebe si los dispositivos de hardware se comunican directamente y de forma independiente con la infraestructura de autenticaci√≥n utilizando un canal de comunicaci√≥n adicional.

6. Pruebe CAPTCHA para las vulnerabilidades de autenticaci√≥n presentadas o no.

7. Verifique si se presentan preguntas/respuestas de seguridad d√©biles .

8. Una inyecci√≥n SQL exitosa podr√≠a provocar la p√©rdida de la confianza del cliente y los atacantes pueden robar n√∫meros de tel√©fono, direcciones y detalles de tarjetas de cr√©dito. Colocar un firewall de aplicaciones web puede filtrar las consultas SQL maliciosas en el tr√°fico.
Pruebas de autorizaci√≥n

1. Pruebe la manipulaci√≥n de funciones y privilegios para acceder a los recursos.

2. Pruebe el recorrido de ruta realizando la enumeraci√≥n de vectores de entrada y analice las funciones de validaci√≥n de entrada presentadas en la aplicaci√≥n web.

3.Prueba de templado de cookies y par√°metros utilizando herramientas de ara√±a web.

4. Pruebe la moderaci√≥n de solicitudes HTTP y verifique si desea obtener acceso ilegal a los recursos reservados.
Pruebas de gesti√≥n de la configuraci√≥n

1. Verifique el directorio y el servidor de revisi√≥n de enumeraci√≥n de archivos y la documentaci√≥n de la aplicaci√≥n. tambi√©n, verifique las interfaces de administraci√≥n de la infraestructura y la aplicaci√≥n.

2. Analice el banner del servidor web y Realice un escaneo de red.

3. Verifique y verifique la presencia de Documentaci√≥n antigua y Copia de seguridad y archivos de referencia, como c√≥digos fuente, contrase√±as, rutas de instalaci√≥n.

4.verifique e identifique los puertos asociados con los servicios SSL/TLS usando NMAP y NESSUS .

5.Revise las OPCIONES del m√©todo HTTP usando Netcat y Telnet.

6. Pruebe los m√©todos HTTP y XST para las credenciales de usuarios leg√≠timos.

7. Realice una prueba de administraci√≥n de la configuraci√≥n de la aplicaci√≥n para revisar la informaci√≥n del c√≥digo fuente, los archivos de registro y los c√≥digos de error predeterminados.
Pruebas de gesti√≥n de sesiones

1. Verifique las URL en el √°rea restringida para probar la falsificaci√≥n de solicitud de vista cruzada.

2. Pruebe las variables de sesi√≥n expuestas inspeccionando el cifrado y la reutilizaci√≥n del token de sesi√≥n, los servidores proxy y el almacenamiento en cach√©, GET&POST .

3. Recopilar una cantidad suficiente de muestras de cookies y analizar el algoritmo de muestra de cookies y falsificar una Cookie v√°lida para realizar un Ataque.

4. Pruebe el atributo de la cookie utilizando servidores proxy de intercepci√≥n, como Burp Proxy, OWASP ZAP , o servidores proxy de intercepci√≥n de tr√°fico, como Temper Data.

5. Pruebe la Fijaci√≥n de la sesi√≥n, para evitar sellar la sesi√≥n del usuario. (Secuestro de sesi√≥n)
Pruebas de validaci√≥n de datos

1. Realizaci√≥n de an√°lisis de c√≥digo fuente para errores de codificaci√≥n de javascript.

2. Realice pruebas de inyecci√≥n SQL Union Query, pruebas de inyecci√≥n SQL est√°ndar, pruebas de consulta SQL ciegas, utilizando herramientas como sqlninja, sqldumper, sql power injector , etc.

3. Analice el c√≥digo HTML, pruebe el XSS almacenado, aproveche el XSS almacenado, utilizando herramientas como XSS proxy, Backframe, Burp Proxy, OWASP, ZAP, XSS Assistant.

4. Realice pruebas de inyecci√≥n de LDAP para obtener informaci√≥n confidencial sobre usuarios y hosts.

5. Realice pruebas de inyecci√≥n de IMAP/SMTP para acceder al servidor de correo backend.

6. Realice pruebas de inyecci√≥n XPATH para acceder a la informaci√≥n confidencial

7. Realice pruebas de inyecci√≥n XML para conocer informaci√≥n sobre la estructura XML.

8. Realice pruebas de inyecci√≥n de c√≥digo para identificar el error de validaci√≥n de entrada.

9. Realice pruebas de desbordamiento de b√∫fer para la informaci√≥n de la pila y la memoria del mont√≥n y el flujo de control de la aplicaci√≥n.

10. Pruebe la divisi√≥n HTTP y el contrabando de cookies e informaci√≥n de redirecci√≥n HTTP.
Pruebas de denegaci√≥n de servicio

1. Env√≠e una gran cantidad de solicitudes que realicen operaciones de base de datos y observe cualquier desaceleraci√≥n y nuevos mensajes de error.

2. Realice un an√°lisis manual del c√≥digo fuente y env√≠e un rango de entrada de diferentes longitudes a las aplicaciones.

3. Prueba de ataques de comodines SQL para pruebas de informaci√≥n de aplicaciones. Las redes empresariales deben elegir los  mejores servicios de prevenci√≥n de ataques DDoS  para garantizar la protecci√≥n contra ataques DDoS y prevenir su red.

4. La prueba para el usuario especifica la asignaci√≥n de objetos si hay un n√∫mero m√°ximo de objetos que la aplicaci√≥n puede manejar.

5. Ingrese un n√∫mero extremadamente grande del campo de entrada utilizado por la aplicaci√≥n como contador de bucle. Proteja el sitio web de futuros ataques. Tambi√©n verifique  el costo del tiempo de inactividad del ataque DDOS de su empresa.

6. Use un script para enviar autom√°ticamente un valor extremadamente largo para que el servidor pueda registrar la solicitud.

## Mira tambi√©n

* Mozilla [WebAppSec/Web Security Verification](https://wiki.mozilla.org/WebAppSec/Web_Security_Verification)
* [WSTG-v4.2 - 4 - Web Application Security Testing](https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/)